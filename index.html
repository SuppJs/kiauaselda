<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OceanGuard // Research Interface</title>

  <script src="https://cdn.jsdelivr.net/npm/canvas-gauges@2.1.7/gauge.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;600&display=swap" rel="stylesheet">
  
  <style>
    :root {
      /* Palette Lab / Scientific */
      --bg-body: #f3f6f9;
      --bg-card: #ffffff;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      
      --accent-depth: #0284c7;    /* Strong Blue */
      --accent-press: #e11d48;    /* Strong Red */
      --accent-oxy: #059669;      /* Strong Green */
      
      --border-light: #e2e8f0;
      --shadow-card: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    }

    body {
      background-color: var(--bg-body);
      font-family: 'Roboto', sans-serif;
      color: var(--text-primary);
      margin: 0;
      padding: 30px;
      min-height: 100vh;
    }

    /* --- Header --- */
    header {
      background: var(--bg-card);
      padding: 20px 30px;
      border-radius: 12px;
      box-shadow: var(--shadow-card);
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      border: 1px solid var(--border-light);
    }

    h2 {
      margin: 0;
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.5px;
    }

    .subtitle {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-top: 4px;
      font-weight: 400;
    }
    
    .status-badge {
      background: #ecfdf5;
      color: #059669;
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 600;
      font-family: 'Roboto Mono', monospace;
      border: 1px solid #d1fae5;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .status-dot {
      width: 10px;
      height: 10px;
      background-color: #10b981;
      border-radius: 50%;
      /* Ripple effect CSS */
      position: relative;
    }
    .status-dot::after {
      content: '';
      position: absolute;
      top: -4px; left: -4px; right: -4px; bottom: -4px;
      border-radius: 50%;
      border: 2px solid #10b981;
      animation: ripple 2s infinite;
      opacity: 0;
    }

    /* --- Grid --- */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 24px;
      margin-bottom: 24px;
    }

    /* --- Cards --- */
    .card {
      background: var(--bg-card);
      border-radius: 12px;
      padding: 24px;
      border: 1px solid var(--border-light);
      box-shadow: var(--shadow-card);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    /* Decorative Top Line per Card type */
    .card.depth-card::before { background: var(--accent-depth); }
    .card.press-card::before { background: var(--accent-press); }
    .card.oxy-card::before { background: var(--accent-oxy); }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 4px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .sensor-id {
      font-family: 'Roboto Mono', monospace;
      font-size: 0.75rem;
      background: #f1f5f9;
      padding: 4px 8px;
      border-radius: 4px;
      color: var(--text-secondary);
      font-weight: 600;
    }

    /* --- Visuals --- */
    .gauge-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 10px 0;
      min-height: 220px;
      /* Light background circle for radial gauges */
      background: radial-gradient(circle, #f8fafc 0%, rgba(255,255,255,0) 70%);
    }

    .chart-wrapper {
      position: relative;
      height: 180px;
      width: 100%;
    }

    .card-metric-value {
        font-family: 'Roboto Mono', monospace;
        font-size: 1.5rem;
        font-weight: 700;
        text-align: center;
        margin-top: -10px;
        margin-bottom: 10px;
        color: var(--text-primary);
    }

    .card-desc {
      margin-top: auto;
      padding-top: 15px;
      font-size: 0.85rem;
      color: var(--text-secondary);
      border-top: 1px solid #f1f5f9;
    }

    /* --- Info Panel --- */
    .info-panel {
      background: #fff;
      border: 1px solid var(--border-light);
      border-radius: 12px;
      padding: 30px;
      margin-top: 40px;
      box-shadow: var(--shadow-card);
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }

    .info-item h4 {
      color: var(--text-primary);
      margin: 0 0 10px 0;
      font-size: 1rem;
      border-bottom: 2px solid var(--border-light);
      display: inline-block;
      padding-bottom: 5px;
    }
    
    .info-item p {
      margin: 0;
      font-size: 0.9rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    code {
      background: #f1f5f9;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Roboto Mono', monospace;
      color: #d63384;
    }

    @keyframes ripple {
      0% { transform: scale(1); opacity: 0.8; }
      100% { transform: scale(2.5); opacity: 0; }
    }

    /* Responsive */
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }
      .status-badge { width: 100%; justify-content: center; box-sizing: border-box; }
    }
  </style>
</head>
<body>

<header>
  <div>
    <h2>OceanGuard <span style="color:var(--accent-depth)">//</span> Research Lab</h2>
    <div class="subtitle">Unit Telemetri Kelautan & Analisis Data</div>
  </div>
  <div class="status-badge">
    <div class="status-dot"></div>
    DATA STREAM ACTIVE
  </div>
</header>

<div class="dashboard-grid">
  
  <div class="card depth-card">
    <div class="card-header">
      <div class="card-title">Kedalaman</div>
      <div class="sensor-id">ID: D-01</div>
    </div>
    <div class="gauge-wrapper">
      <canvas id="gaugeDepth" width="120" height="300"
        data-type="linear-gauge"
        data-min-value="0"
        data-max-value="200"
        data-major-ticks="0,50,100,150,200"
        data-minor-ticks="5"
        data-units="m"
        data-bar-begin-circle="false"
        data-tick-side="right"
        data-number-side="right"
        data-needle-side="right"
        data-bar-width="10"
        data-color-bar-progress="#0284c7"
        data-color-plate="transparent"
        data-color-major-ticks="#334155"
        data-color-minor-ticks="#94a3b8"
        data-color-numbers="#334155"
        data-color-units="#64748b"
        data-border-shadow-width="0"
        data-borders="false"
        data-needle-type="arrow"
        data-needle-width="4"
        data-needle-color="#334155"
        data-animation-duration="1500"
        data-animation-rule="linear"
      ></canvas>
    </div>
    <div class="card-desc">
      Posisi vertikal sensor relatif terhadap permukaan laut.
    </div>
  </div>

  <div class="card press-card">
    <div class="card-header">
      <div class="card-title">Tekanan Absolut</div>
      <div class="sensor-id">ID: P-02</div>
    </div>
    <div class="gauge-wrapper">
      <canvas id="gaugePressure" width="220" height="220"
        data-type="radial-gauge"
        data-min-value="0"
        data-max-value="30"
        data-major-ticks="0,5,10,15,20,25,30"
        data-units="atm"
        data-title="PRESSURE"
        data-color-plate="transparent"
        data-color-major-ticks="#334155"
        data-color-minor-ticks="#94a3b8"
        data-color-numbers="#334155"
        data-color-title="#64748b"
        data-color-units="#64748b"
        data-border-shadow-width="0"
        data-borders="false"
        data-needle-type="line"
        data-needle-width="3"
        data-needle-circle-size="8"
        data-needle-circle-outer="true"
        data-needle-circle-inner="false"
        data-color-needle="#e11d48"
        data-color-needle-end="#e11d48"
        data-color-needle-circle-outer="#e11d48"
        data-color-bar-progress="#e11d48"
        data-color-bar="#e2e8f0"
        data-value-box="true"
        data-font-value="Roboto Mono"
        data-color-value-box-rect="#f1f5f9"
        data-color-value-box-rect-end="#f1f5f9"
        data-color-value-text="#1e293b"
      ></canvas>
    </div>
    <div class="card-desc">
      Tekanan hidrostatik terukur (1 atm ≈ 10m kedalaman).
    </div>
  </div>

  <div class="card oxy-card">
    <div class="card-header">
      <div class="card-title">Dissolved Oxygen</div>
      <div class="sensor-id">ID: OX-03</div>
    </div>
    <div class="gauge-wrapper">
      <canvas id="gaugeOksigen" width="220" height="220"
        data-type="radial-gauge"
        data-min-value="0"
        data-max-value="12"
        data-major-ticks="0,2,4,6,8,10,12"
        data-units="mg/L"
        data-title="OXYGEN"
        data-color-plate="transparent"
        data-color-major-ticks="#334155"
        data-color-minor-ticks="#94a3b8"
        data-color-numbers="#334155"
        data-color-title="#64748b"
        data-color-units="#64748b"
        data-border-shadow-width="0"
        data-borders="false"
        data-needle-type="line"
        data-needle-width="3"
        data-needle-circle-size="8"
        data-needle-circle-outer="true"
        data-needle-circle-inner="false"
        data-color-needle="#059669"
        data-color-needle-end="#059669"
        data-color-needle-circle-outer="#059669"
        data-color-bar-progress="#059669"
        data-color-bar="#e2e8f0"
        data-value-box="true"
        data-font-value="Roboto Mono"
        data-color-value-box-rect="#f1f5f9"
        data-color-value-box-rect-end="#f1f5f9"
        data-color-value-text="#1e293b"
      ></canvas>
    </div>
    <div class="card-desc">
      Parameter vitalitas ekosistem. Ambang bahaya: < 3 mg/L.
    </div>
  </div>

</div>

<div class="dashboard-grid">
  
  <div class="card">
    <div class="card-header">
      <div class="card-title" style="color:var(--accent-depth)">Trend Kedalaman</div>
      <span style="font-size:11px; color:var(--text-secondary); background:#f1f5f9; padding:2px 6px; border-radius:4px;">REAL-TIME</span>
    </div>
    <div class="chart-wrapper">
      <canvas id="chartDepth"></canvas>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-title" style="color:var(--accent-press)">Trend Tekanan</div>
      <span style="font-size:11px; color:var(--text-secondary); background:#f1f5f9; padding:2px 6px; border-radius:4px;">REAL-TIME</span>
    </div>
    <div class="chart-wrapper">
      <canvas id="chartPressure"></canvas>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-title" style="color:var(--accent-oxy)">Trend Oksigen</div>
      <span style="font-size:11px; color:var(--text-secondary); background:#f1f5f9; padding:2px 6px; border-radius:4px;">REAL-TIME</span>
    </div>
    <div class="chart-wrapper">
      <canvas id="chartOksigen"></canvas>
    </div>
  </div>

</div>

<div class="info-panel">
  <div style="margin-bottom: 25px;">
    <h3 style="margin:0; color:var(--text-primary)">Referensi Parameter</h3>
    <span style="color:var(--text-secondary); font-size:0.9rem">Panduan analisis data sensor</span>
  </div>
  <div class="info-grid">
    <div class="info-item">
      <h4>Hukum Pascal (Tekanan)</h4>
      <p>Tekanan meningkat secara linear terhadap kedalaman. Pada air laut, tekanan bertambah 1 atmosfer setiap penurunan kedalaman 10 meter. Rumus: <code>P = P0 + ρgh</code>.</p>
    </div>
    <div class="info-item">
      <h4>Stratifikasi Oksigen</h4>
      <p>Kadar oksigen tertinggi berada di permukaan (zona fotik) akibat fotosintesis dan difusi udara. Kadar menurun drastis pada zona afotik (gelap).</p>
    </div>
    <div class="info-item">
      <h4>Zona Hipoksia</h4>
      <p>Area dengan kadar Oksigen <strong>< 2-3 mg/L</strong>. Sering disebut "Dead Zone" dimana organisme bentik tidak dapat bertahan hidup.</p>
    </div>
  </div>
</div>

<script>
window.onload = function () {

  // Warna Tema JS (Disesuaikan untuk Light Theme)
  const colors = {
    depth: '#0284c7',    // Darker Blue
    pressure: '#e11d48', // Darker Red
    oxygen: '#059669',   // Darker Emerald
    grid: '#e2e8f0',     // Light Grey for Grid
    text: '#64748b'      // Slate 500 for Axis text
  };

  // GAUGES references
  let gDepth    = document.gauges.get('gaugeDepth');
  let gPressure = document.gauges.get('gaugePressure');
  let gOxygen   = document.gauges.get('gaugeOksigen');

  // CHART CREATOR FUNCTION
  function createChart(id, min, max, color, label) {
    const ctx = document.getElementById(id).getContext("2d");
    
    // Gradient Fill (Updated for Light Theme softness)
    let gradient = ctx.createLinearGradient(0, 0, 0, 200);
    gradient.addColorStop(0, color + "66"); // 40% opacity
    gradient.addColorStop(1, "#ffffff00");  // fade to transparent

    return new Chart(ctx, {
      type: 'line',
      data: {
        labels: Array(20).fill(""),
        datasets: [{
          label: label,
          data: Array(20).fill(min),
          borderWidth: 2,
          tension: 0.4, 
          borderColor: color,
          backgroundColor: gradient,
          pointRadius: 0, 
          pointHoverRadius: 5,
          pointHoverBackgroundColor: color,
          fill: true
        }]
      },
      options: { 
        animation: false, 
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            mode: 'index',
            intersect: false,
            backgroundColor: '#fff',     // White background
            titleColor: '#1e293b',       // Dark text
            bodyColor: '#1e293b',        // Dark text
            borderColor: '#e2e8f0',      // Light border
            borderWidth: 1,
            titleFont: { family: 'Roboto', size: 13 },
            bodyFont: { family: 'Roboto Mono', size: 12 },
            padding: 10,
            displayColors: false
          }
        },
        scales: { 
          y: { 
            min: min, 
            max: max,
            grid: { color: colors.grid, borderDash: [4, 4] },
            ticks: { color: colors.text, font: { family: 'Roboto Mono', size: 10 } },
            border: { display: false }
          },
          x: {
            grid: { display: false },
            ticks: { display: false }
          }
        },
        interaction: {
          mode: 'nearest',
          axis: 'x',
          intersect: false
        }
      }
    });
  }
  
  let chartDepth    = createChart("chartDepth", 0, 200, colors.depth, "Kedalaman (m)");
  let chartPressure = createChart("chartPressure", 0, 30, colors.pressure, "Tekanan (atm)");
  let chartOxygen   = createChart("chartOksigen", 0, 12, colors.oxygen, "Oksigen (mg/L)");

  // SIMULASI LOOP (Tidak diubah logikanya)
  let time = 0;
  
  setInterval(() => {
    // Simulasi Gerakan Gelombang Sine Wave yang lebih natural
    time += 0.1;
    
    // Kedalaman bervariasi random tapi smooth
    let noise = (Math.random() - 0.5) * 20;
    let baseDepth = 100 + (Math.sin(time) * 50); // Bergerak antara 50m - 150m
    let depth = baseDepth + noise;
    if(depth < 0) depth = 0;
    if(depth > 200) depth = 200;

    // Fisika Sederhana
    let pressure = 1 + (depth / 10); // 1 atm udara + air
    
    // Oksigen (Makin dalam makin sedikit, plus noise)
    let oxyBase = 9 - (depth * 0.035); 
    let oxygen = oxyBase + (Math.random() * 0.5);
    if (oxygen < 1) oxygen = 1;

    // Update Gauges
    gDepth.value    = depth;
    gPressure.value = pressure;
    gOxygen.value   = oxygen;

    // Update Charts
    function pushData(chart, val) {
      chart.data.datasets[0].data.shift();
      chart.data.datasets[0].data.push(val);
      chart.update('none'); 
    }

    pushData(chartDepth, depth);
    pushData(chartPressure, pressure);
    pushData(chartOxygen, oxygen);

  }, 2000); 

};
</script>

</body>
</html>
